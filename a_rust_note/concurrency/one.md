# 无畏并发

- 并发编程，代表程序的不同部分相互独立的执行
- 并行编程，代表程序不同部分与同时执行

- 所有权和类型系统是一系列解决内存安全和并发问题的强有力的工具

- 如何从创建线程来同时运行多段代码
- 消息传递并发，其中信道被用来在线程间传递消息
- 共享状态并发，其中多线程可以访问同一片数据
- Sync、 Send trait

# 使用线程同时运行代码

- 已执行的代码在一个进程process中运行，操作系统则负责管理多个进程

- 程序内部，也可以拥有多个同时运行的独立部分。运行这些独立的功能被称为线程Threads

- 线程同时运行导致的问题：
  - 竞态条件，多个线程以不一致的顺序访问数据或资源
  - 死锁，两个线程相互等待对方停止使用其所拥有的资源，这会阻止它们继续运行
  - 只会发生在特定情况下且难以稳定重现和修复的bug

## 使用 spawn创建新线丞
- 调用thread::spawn函数并传递一个2闭包，并在其中包含希望运行的代码

- thread::sleep()，调用强制线程停止执行一小段时间，这会允许其他不同的线程运行

- 当主线程结束时，新线程也会结束，不管其是否执行完毕。

## 使用join等待所有线程结束
- thread::spawn的返回值类型是JoinHandle，是一个拥有所有权的值，当对其调用join方法时，它会等待其线程结束

- `handle.join().unwrap();`

## 线程与move闭包
- move关键字经常用于传递给thread::spawn的闭包，因为闭包会获取从环境中取得值的所有权，因此会将这些值的所有权从一个线程传送到另一个线程

